# ä¸­å›½èŠ‚å‡æ—¥MCPæœåŠ¡å™¨

ä¸€ä¸ªåŸºäºæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰çš„ä¸­å›½èŠ‚å‡æ—¥å’Œå†œå†ä¿¡æ¯æœåŠ¡å™¨ï¼Œä¸ºAIåŠ©æ‰‹æä¾›å‡†ç¡®çš„æ³•å®šèŠ‚å‡æ—¥ã€è°ƒä¼‘å®‰æ’ã€ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥ã€å†œå†è½¬æ¢ã€äºŒåå››èŠ‚æ°”å’Œå…«å­—è®¡ç®—åŠŸèƒ½ã€‚è¥¿æ–¹èŠ‚æ—¥éƒ½æ˜¯å›ºå®šå…¬å†æ—¥æœŸï¼Œä¸éœ€è¦æŸ¥è¯¢å·¥å…·ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- **èŠ‚å‡æ—¥æŸ¥è¯¢**: æŸ¥è¯¢ä¸­å›½æ³•å®šèŠ‚å‡æ—¥ã€ä¼ ç»ŸèŠ‚æ—¥å’Œè°ƒä¼‘å®‰æ’
- **å†œå†è½¬æ¢**: å…¬å†ä¸å†œå†æ—¥æœŸç›¸äº’è½¬æ¢
- **å†œå†ä¿¡æ¯**: è·å–è¯¦ç»†çš„å†œå†æ—¥æœŸæè¿°ï¼ŒåŒ…æ‹¬ç”Ÿè‚–ã€å¹²æ”¯ç­‰
- **äºŒåå››èŠ‚æ°”**: æŸ¥è¯¢äºŒåå››èŠ‚æ°”ä¿¡æ¯å’Œå­£èŠ‚åˆ’åˆ†
- **å…«å­—è®¡ç®—**: æ ¹æ®å‡ºç”Ÿæ—¥æœŸæ—¶é—´è®¡ç®—å››æŸ±å…«å­—å’Œäº”è¡Œå±æ€§
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å‚æ•°éªŒè¯å’Œé”™è¯¯å¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„æ“ä½œæ—¥å¿—å’Œæ€§èƒ½ç›‘æ§
- **FastMCPæ¶æ„**: åŸºäºå®˜æ–¹æ¨èçš„FastMCPæ¡†æ¶ï¼Œæä¾›æ›´å¥½çš„æ€§èƒ½å’Œç¨³å®šæ€§

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨äº†å®˜æ–¹æ¨èçš„FastMCPæ¡†æ¶é‡æ„ï¼Œç›¸æ¯”ä¼ ç»ŸMCPå®ç°å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

### FastMCP æ ¸å¿ƒç‰¹æ€§

- **ç®€åŒ–çš„å·¥å…·æ³¨å†Œ**: ä½¿ç”¨ `@mcp.tool()` è£…é¥°å™¨ï¼Œä»£ç æ›´ç®€æ´ç›´è§‚
- **è‡ªåŠ¨ç±»å‹éªŒè¯**: FastMCPè‡ªåŠ¨å¤„ç†å‚æ•°éªŒè¯å’Œç±»å‹è½¬æ¢ï¼Œå‡å°‘æ‰‹åŠ¨éªŒè¯ä»£ç 
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œè‡ªåŠ¨åŒ…è£…é”™è¯¯å“åº”
- **æ€§èƒ½ä¼˜åŒ–**: æ›´é«˜æ•ˆçš„è¯·æ±‚å¤„ç†å’Œèµ„æºç®¡ç†ï¼Œæ”¯æŒå¼‚æ­¥æ“ä½œ
- **æ ‡å‡†åŒ–æ¥å£**: å®Œå…¨ç¬¦åˆMCPåè®®æœ€ä½³å®è·µ
- **å¼€å‘ä½“éªŒ**: æä¾›ä¸°å¯Œçš„å¼€å‘å·¥å…·å’Œè°ƒè¯•ä¿¡æ¯

### æ¶æ„å¯¹æ¯”

| ç‰¹æ€§ | ä¼ ç»ŸMCP | FastMCP |
|------|---------|----------|
| å·¥å…·æ³¨å†Œ | æ‰‹åŠ¨æ³¨å†Œ | è£…é¥°å™¨è‡ªåŠ¨æ³¨å†Œ |
| ç±»å‹éªŒè¯ | æ‰‹åŠ¨éªŒè¯ | è‡ªåŠ¨éªŒè¯ |
| é”™è¯¯å¤„ç† | æ‰‹åŠ¨åŒ…è£… | è‡ªåŠ¨å¤„ç† |
| ä»£ç é‡ | è¾ƒå¤š | æ˜¾è‘—å‡å°‘ |
| ç»´æŠ¤æ€§ | ä¸­ç­‰ | ä¼˜ç§€ |
| æ€§èƒ½ | è‰¯å¥½ | æ›´ä¼˜ |

## ğŸ“¦ å®‰è£…

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- FastMCP 2.11.3+
- æ”¯æŒMCPåè®®çš„AIå®¢æˆ·ç«¯ï¼ˆå¦‚Claude Desktopï¼‰

### å¿«é€Ÿå®‰è£…ï¼ˆæ¨èï¼‰

ä½¿ç”¨uvxå¯ä»¥ç›´æ¥è¿è¡Œï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ä¾èµ–ï¼š

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/china-festival-mcp.git
cd china-festival-mcp

# ç›´æ¥è¿è¡Œï¼ˆuvxä¼šè‡ªåŠ¨å®‰è£…ä¾èµ–ï¼‰
uvx --from . python -m src.server_fastmcp
```

### ä¼ ç»Ÿå®‰è£…æ–¹å¼

1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/china-festival-mcp.git
cd china-festival-mcp
```

2. å®‰è£…ä¾èµ–
```bash
pip install fastmcp httpx pydantic psutil
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨uvxè¿è¡Œï¼ˆæ¨èï¼‰

ä½¿ç”¨uvxå¯ä»¥ç›´æ¥è¿è¡Œï¼Œæ— éœ€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š

```bash
uvx --from . python -m src.server_fastmcp
```

### æ–¹æ³•äºŒï¼šä¼ ç»Ÿæ–¹å¼è¿è¡Œ

```bash
python -m src.server_fastmcp
```

## âš™ï¸ MCPå®¢æˆ·ç«¯é…ç½®

æœ¬é¡¹ç›®æä¾›äº†å¤šç§MCPå®¢æˆ·ç«¯é…ç½®æ–¹å¼ï¼Œé€‚ç”¨äºä¸åŒçš„ä½¿ç”¨åœºæ™¯ã€‚é…ç½®æ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•ï¼š

- `mcp_client_config.json` - åŸºç¡€é…ç½®æ–‡ä»¶
- `mcp_config_examples.json` - è¯¦ç»†é…ç½®ç¤ºä¾‹

### Claude Desktopé…ç½®

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨uvxï¼ˆæ¨èï¼‰

ç¼–è¾‘ `~/Library/Application Support/Claude/claude_desktop_config.json`ï¼š

```json
{
  "mcpServers": {
    "china-festival-mcp": {
      "command": "uvx",
      "args": [
        "--from",
        "china-festival-mcp",
        "fastmcp",
        "run",
        "src/server_fastmcp.py:mcp"
      ]
    }
  }
}
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘

```json
{
  "mcpServers": {
    "china-festival-mcp": {
      "command": "python3",
      "args": ["-m", "src.server_fastmcp"],
      "cwd": "/path/to/china-festival-mcp",
      "env": {
        "PYTHONPATH": ".",
        "LOG_LEVEL": "DEBUG"
      }
    }
  }
}
```

### Cline VSCodeæ‰©å±•é…ç½®

åœ¨Clineè®¾ç½®ä¸­æ·»åŠ MCPæœåŠ¡å™¨ï¼š

```json
{
  "mcpServers": {
    "china-festival-mcp": {
      "command": "uvx",
      "args": [
        "--from",
        "china-festival-mcp",
        "fastmcp",
        "run",
        "src/server_fastmcp.py:mcp"
      ]
    }
  }
}
```

### å…¶ä»–MCPå®¢æˆ·ç«¯

å¯¹äºå…¶ä»–æ”¯æŒMCPåè®®çš„å®¢æˆ·ç«¯ï¼Œè¯·å‚è€ƒ `mcp_config_examples.json` æ–‡ä»¶ä¸­çš„è¯¦ç»†é…ç½®ç¤ºä¾‹ã€‚

### é…ç½®è¯´æ˜

- **command**: æ‰§è¡Œå‘½ä»¤ï¼Œæ¨èä½¿ç”¨ `uvx` è¿›è¡Œä¾èµ–ç®¡ç†
- **args**: å‘½ä»¤å‚æ•°ï¼ŒFastMCPä½¿ç”¨ `fastmcp run` å¯åŠ¨æœåŠ¡å™¨
- **cwd**: å·¥ä½œç›®å½•ï¼Œè®¾ç½®ä¸ºé¡¹ç›®æ ¹ç›®å½•
- **env**: ç¯å¢ƒå˜é‡ï¼Œå¯è®¾ç½®æ—¥å¿—çº§åˆ«ç­‰å‚æ•°

## ğŸ“š APIæ–‡æ¡£

### èŠ‚å‡æ—¥å·¥å…·

#### `holiday_info`
æŸ¥è¯¢æŒ‡å®šæ—¥æœŸçš„èŠ‚å‡æ—¥ä¿¡æ¯ï¼ŒåŒ…å«æ˜¯å¦ä¸ºèŠ‚å‡æ—¥çš„åˆ¤æ–­

**å‚æ•°:**
- `date` (string, å¯é€‰): æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DDï¼Œä¸æŒ‡å®šåˆ™æŸ¥è¯¢å½“å‰æ—¥æœŸ

**è¿”å›:**
```json
{
  "date": "2024-01-01",
  "name": "å…ƒæ—¦",
  "type": "holiday",
  "is_holiday": true,
  "is_work_day": false,
  "note": "æ³•å®šèŠ‚å‡æ—¥",
  "weekday_name_en": "Monday"
}
```

#### `next_holiday`
è·å–ä¸‹ä¸€ä¸ªèŠ‚å‡æ—¥

**å‚æ•°:**
æ— 

**è¿”å›:**
```json
{
  "name": "æ˜¥èŠ‚",
  "date": "2024-02-10",
  "days_until": 40,
  "note": "æ³•å®šèŠ‚å‡æ—¥",
  "weekday_name_en": "Saturday"
}
```

#### `current_year_holidays`
è·å–å½“å‰å¹´ä»½æ‰€æœ‰èŠ‚å‡æ—¥

**å‚æ•°:**
æ— 

**è¿”å›:**
```json
{
  "year": 2024,
  "holidays": [
    {
      "date": "2024-01-01",
      "name": "å…ƒæ—¦",
      "note": "æ³•å®šèŠ‚å‡æ—¥"
    }
  ],
  "total_count": 1
}
```

#### `current_year_work_days`
è·å–å½“å‰å¹´ä»½è°ƒä¼‘å·¥ä½œæ—¥å®‰æ’

**å‚æ•°:**
æ— 

**è¿”å›:**
```json
{
  "year": 2024,
  "work_days": [
    {
      "date": "2024-02-04",
      "name": "æ˜¥èŠ‚è°ƒä¼‘",
      "note": "è°ƒä¼‘å·¥ä½œæ—¥"
    }
  ],
  "total_count": 1
}
```

### å†œå†å·¥å…·

#### `gregorian_to_lunar`
å…¬å†è½¬å†œå†

**å‚æ•°:**
- `date` (string): å…¬å†æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DD

**è¿”å›:**
```json
{
  "gregorian_date": "2024-01-01",
  "lunar_year": 2023,
  "lunar_month": 11,
  "lunar_day": 20,
  "is_leap_month": false,
  "zodiac": "å…”"
}
```

#### `lunar_to_gregorian`
å†œå†è½¬å…¬å†

**å‚æ•°:**
- `year` (integer): å†œå†å¹´ä»½
- `month` (integer): å†œå†æœˆä»½
- `day` (integer): å†œå†æ—¥æœŸ
- `is_leap` (boolean, å¯é€‰): æ˜¯å¦é—°æœˆï¼Œé»˜è®¤false

**è¿”å›:**
```json
{
  "lunar_date": "2023å¹´åä¸€æœˆäºŒå",
  "gregorian_year": 2024,
  "gregorian_month": 1,
  "gregorian_day": 1,
  "gregorian_date": "2024-01-01"
}
```

#### `get_lunar_string`
è·å–å†œå†æ—¥æœŸçš„è¯¦ç»†ä¸­æ–‡æè¿°

**å‚æ•°:**
- `date` (string): å…¬å†æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DD

**è¿”å›:**
```json
{
  "gregorian_date": "2024-01-01",
  "lunar_year": 2023,
  "lunar_month": 11,
  "lunar_day": 20,
  "is_leap_month": false,
  "zodiac": "å…”",
  "year_gan_zhi": "ç™¸å¯",
  "tian_gan": "ç™¸",
  "di_zhi": "å¯",
  "lunar_month_name": "åä¸€æœˆ",
  "lunar_day_name": "äºŒå",
  "lunar_string": "ç™¸å¯å¹´ åä¸€æœˆ äºŒå"
}
```

#### `get_24_lunar_feast`
è·å–äºŒåå››èŠ‚æ°”ä¿¡æ¯

**å‚æ•°:**
- `date` (string): æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DD

**è¿”å›:**
```json
{
  "year": 2024,
  "month": 1,
  "solar_terms": [
    {
      "name": "å°å¯’",
      "date": "2024-01-06",
      "days_until": 5,
      "season": "å†¬å­£"
    },
    {
      "name": "å¤§å¯’",
      "date": "2024-01-20",
      "days_until": 19,
      "season": "å†¬å­£"
    }
  ]
}
```

#### `get_8zi`
è®¡ç®—å…«å­—ï¼ˆå››æŸ±ï¼‰

**å‚æ•°:**
- `date` (string): æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DD
- `hour` (integer, å¯é€‰): å°æ—¶ï¼Œ0-23ï¼Œé»˜è®¤12
- `minute` (integer, å¯é€‰): åˆ†é’Ÿï¼Œ0-59ï¼Œé»˜è®¤0

**è¿”å›:**
```json
{
  "eight_characters": "ç”²è¾° ä¸™å¯… ç”²å­ åºšåˆ"
}
```

### æ—¥æœŸå·¥å…·

#### `get_weekday`
æ ¹æ®å…¬å†æ—¥æœŸè®¡ç®—æ˜ŸæœŸå‡ 

**å‚æ•°:**
- `date` (string): æ—¥æœŸï¼Œæ ¼å¼ä¸º YYYY-MM-DDï¼Œå¦‚ï¼š2024-01-01

**è¿”å›:**
```json
{
  "weekday_number": 1,
  "weekday_name_zh": "æ˜ŸæœŸä¸€",
  "weekday_name_en": "Monday",
  "date": "2024-01-01"
}
```

## ğŸ§ª æµ‹è¯•

è¿è¡ŒåŸºç¡€æµ‹è¯•ï¼š
```bash
python tests/test_server.py
```

è¿è¡Œå…¨é¢æµ‹è¯•ï¼š
```bash
python tests/comprehensive_test.py
```

è¿è¡Œæ€§èƒ½æµ‹è¯•ï¼š
```bash
python tests/performance_test.py
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
china-festival-mcp/
â”œâ”€â”€ src/                       # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ server.py              # ä¼ ç»ŸMCPæœåŠ¡å™¨ï¼ˆå·²å¼ƒç”¨ï¼‰
â”‚   â”œâ”€â”€ server_fastmcp.py      # FastMCPæœåŠ¡å™¨ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ data/                  # æ•°æ®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ bazi_calculator.py # å…«å­—è®¡ç®—æ¨¡å—
â”‚   â”‚   â””â”€â”€ solar_terms.py     # äºŒåå››èŠ‚æ°”æ•°æ®
â”‚   â”œâ”€â”€ tools/                 # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ holiday.py         # èŠ‚å‡æ—¥æŸ¥è¯¢å·¥å…·
â”‚   â”‚   â”œâ”€â”€ lunar.py           # å†œå†è½¬æ¢å·¥å…·
â”‚   â”‚   â””â”€â”€ weekday.py         # æ˜ŸæœŸè®¡ç®—å·¥å…·
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ cache.py           # ç¼“å­˜ç®¡ç†
â”‚       â”œâ”€â”€ date_utils.py      # æ—¥æœŸå·¥å…·
â”‚       â”œâ”€â”€ error_handler.py   # é”™è¯¯å¤„ç†
â”‚       â”œâ”€â”€ logger.py          # æ—¥å¿—ç®¡ç†
â”‚       â””â”€â”€ performance.py     # æ€§èƒ½ç›‘æ§
â”œâ”€â”€ tests/                     # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ comprehensive_test.py  # ç»¼åˆæµ‹è¯•
â”‚   â”œâ”€â”€ performance_test.py    # æ€§èƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_server.py         # æœåŠ¡å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ test_24_lunar_feast_format.py
â”‚   â””â”€â”€ test_8zi_format.py
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”‚   â”œâ”€â”€ INSTALLATION_GUIDE.md  # å®‰è£…æŒ‡å—
â”‚   â”œâ”€â”€ USAGE_EXAMPLES.md      # ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ ä¸­å›½èŠ‚å‡æ—¥MCP_PRD.md   # äº§å“éœ€æ±‚æ–‡æ¡£
â”œâ”€â”€ scripts/                   # å‚è€ƒè„šæœ¬
â”‚   â”œâ”€â”€ CalendarConvert.py     # æ—¥å†è½¬æ¢å‚è€ƒ
â”‚   â””â”€â”€ holiday_query.py       # èŠ‚å‡æ—¥æŸ¥è¯¢å‚è€ƒ
â”œâ”€â”€ logs/                      # æ—¥å¿—æ–‡ä»¶ï¼ˆgitå¿½ç•¥ï¼‰
â”œâ”€â”€ build/                     # æ„å»ºæ–‡ä»¶ï¼ˆgitå¿½ç•¥ï¼‰
â”œâ”€â”€ venv/                      # è™šæ‹Ÿç¯å¢ƒï¼ˆgitå¿½ç•¥ï¼‰
â”œâ”€â”€ .gitignore                 # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ pyproject.toml             # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ LICENSE                    # è®¸å¯è¯
â”œâ”€â”€ mcp_client_config.json     # MCPå®¢æˆ·ç«¯é…ç½®
â””â”€â”€ mcp_config_examples.json   # é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ holiday.py         # èŠ‚å‡æ—¥æŸ¥è¯¢å·¥å…·
â”‚   â”‚   â”œâ”€â”€ lunar.py           # å†œå†ç›¸å…³å·¥å…·
â”‚   â”‚   â””â”€â”€ weekday.py         # æ˜ŸæœŸå‡ æŸ¥è¯¢å·¥å…·
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ cache.py           # ç¼“å­˜å·¥å…·
â”‚       â”œâ”€â”€ date_utils.py      # æ—¥æœŸå·¥å…·
â”‚       â”œâ”€â”€ error_handler.py   # é”™è¯¯å¤„ç†
â”‚       â”œâ”€â”€ logger.py          # æ—¥å¿—è®°å½•
â”‚       â””â”€â”€ performance.py     # æ€§èƒ½ç›‘æ§
â”œâ”€â”€ test_server.py             # åŸºç¡€æµ‹è¯•è„šæœ¬
â”œâ”€â”€ comprehensive_test.py      # å…¨é¢æµ‹è¯•è„šæœ¬
â”œâ”€â”€ pyproject.toml            # é¡¹ç›®é…ç½®ï¼ˆå·²æ›´æ–°ä¸ºFastMCPï¼‰
â””â”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”§ é…ç½®

### æ—¥å¿—é…ç½®

æ—¥å¿—æ–‡ä»¶é»˜è®¤ä¿å­˜åœ¨ `logs/` ç›®å½•ä¸‹ï¼ŒæŒ‰æ—¥æœŸåˆ†å‰²ã€‚å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼š

```bash
export LOG_LEVEL=INFO
export LOG_DIR=./logs
```

### ç¼“å­˜é…ç½®

æ”¯æŒå†…å­˜ç¼“å­˜ä»¥æé«˜æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼š

```bash
export CACHE_ENABLED=true
export CACHE_TTL=3600
```


## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäº [PyLunar](https://github.com/swordzjj/PyLunar/tree/master) é¡¹ç›®å’Œ [holiday-cn](https://github.com/NateScarlet/holiday-cn)é¡¹ç›®å¼€å‘ï¼Œæ„Ÿè°¢åŸä½œè€…çš„è´¡çŒ®ã€‚

- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…
- åŸºäºä¼ ç»Ÿå†œå†ç®—æ³•å’Œç°ä»£è®¡ç®—æ–¹æ³•
- å‚è€ƒäº†å¤šä¸ªå¼€æºå†œå†è½¬æ¢é¡¹ç›®
